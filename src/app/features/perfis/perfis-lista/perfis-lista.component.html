<div class="perfis-lista-container">
  <!-- Breadcrumb -->
  <app-breadcrumb [items]="breadcrumbItems"></app-breadcrumb>

  <!-- Page Header -->
  <app-page-header
    title="Perfis de Acesso"
    subtitle="Gerencie os perfis e suas permissões no sistema"
    icon="pi pi-shield"
    [actions]="headerActions">
  </app-page-header>

  <!-- Tabela genérica com templates customizados -->
  <app-data-table
    [data]="perfis"
    [columns]="colunas"
    [actions]="acoes"
    [loading]="carregando"
    [globalFilterFields]="[]"
    [rows]="pageSize"
    [rowsPerPageOptions]="[]"
    [lazy]="false"
    [totalRecords]="totalElements"
    (onSearch)="onSearch($event)">
    
    <!-- Template para Status -->
    <ng-template appTableTemplate="status" let-perfil="rowData">
      <p-tag 
        [value]="perfil.ativo ? 'Ativo' : 'Inativo'" 
        [severity]="perfil.ativo ? 'success' : 'danger'">
      </p-tag>
    </ng-template>

    <!-- Template para Funcionalidades -->
    <ng-template appTableTemplate="funcionalidades" let-perfil="rowData">
      <div class="badge-info">
        <i class="pi pi-list"></i>
        <span class="badge-count">{{ getTotalFuncionalidades(perfil) }}</span>
      </div>
    </ng-template>

    <!-- Template para Permissões -->
    <ng-template appTableTemplate="permissoes" let-perfil="rowData">
      <div class="badge-info">
        <i class="pi pi-key"></i>
        <span class="badge-count">{{ getTotalPermissoes(perfil) }}</span>
      </div>
    </ng-template>

    <!-- Template para estado vazio -->
    <ng-template appTableTemplate="empty">
      <div class="empty-state">
        <i class="pi pi-shield empty-icon"></i>
        <h3>Nenhum perfil cadastrado</h3>
        <p>Comece criando o primeiro perfil de acesso do sistema</p>
        <app-custom-button
          *ngIf="podeIncluir"
          label="Criar Primeiro Perfil" 
          icon="pi pi-plus"
          severity="success"
          size="large"
          [raised]="true"
          (onClick)="novoPerfil()">
        </app-custom-button>
      </div>
    </ng-template>
  </app-data-table>
</div>

<!-- Dialog de confirmação -->
<p-confirmDialog></p-confirmDialog>

